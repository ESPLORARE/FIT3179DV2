{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 900,
  "height": 420,
  "title": {
    "text": "Malaysia Crude Oil Imports vs Exports (2012â€“2023)",
    "subtitle": "Source: ESPLORARE/FIT3179DV2",
    "anchor": "start"
  },
  "data": {
    "url": "https://raw.githubusercontent.com/ESPLORARE/FIT3179DV2/refs/heads/main/malaysia_crude_oil_imports_exports_2012_2023.csv"
  },

  "params": [
    {
      "name": "Year_End",
      "value": 2023,
      "bind": { "input": "range", "min": 2012, "max": 2023, "step": 1, "name": "End Year: " }
    }
  ],

  "transform": [
    { "fold": ["Imports", "Exports"], "as": ["Flow", "Value"] },
    { "calculate": "toNumber(datum.Year)", "as": "YearNum" },
    { "filter": "datum.YearNum >= 2012 && datum.YearNum <= Year_End" }
  ],

  "encoding": {
    "x": {
      "field": "YearNum",
      "type": "quantitative",
      "title": "Year",
      "axis": { "format": "d", "grid": false },
      "scale": { "domainMin": 2012, "nice": false }
    },
    "y": {
      "field": "Value",
      "type": "quantitative",
      "title": "Million barrels",
      "stack": null,
      "axis": { "grid": false }
    },
    "color": {
      "field": "Flow",
      "type": "nominal",
      "scale": {
        "domain": ["Exports", "Imports"],
        "range": ["#0072B2", "#D55E00"] 
      },
      "title": null
    },
    "tooltip": [
      { "field": "YearNum", "title": "Year", "format": "d" },
      { "field": "Flow", "title": "Flow" },
      { "field": "Value", "title": "Value (million bbl)", "format": ".3f" }
    ]
  },

  "layer": [
    { "mark": { "type": "area", "opacity": 0.25, "interpolate": "monotone" } },
    { "mark": { "type": "line", "strokeWidth": 2, "interpolate": "monotone" } },
    {
      "selection": { "hover": { "type": "single", "on": "pointerover", "nearest": true, "empty": "none" } },
      "mark": { "type": "point", "filled": true, "size": 55 },
      "encoding": { "opacity": { "condition": { "param": "hover", "value": 1 }, "value": 0 } }
    }
  ],

  "config": {
    "view": { "stroke": null },
    "axis": { "grid": false }  
  }
}
